'use strict';const a38_0x1d48de=a38_0x4979;function a38_0x4979(_0x112349,_0x538ece){const _0x380086=a38_0x3800();return a38_0x4979=function(_0x4979b8,_0x283ca1){_0x4979b8=_0x4979b8-0x12e;let _0x1950fb=_0x380086[_0x4979b8];return _0x1950fb;},a38_0x4979(_0x112349,_0x538ece);}(function(_0x17ad96,_0x5a2270){const _0x4ef69f=a38_0x4979,_0x349f7a=_0x17ad96();while(!![]){try{const _0x33fc28=-parseInt(_0x4ef69f(0x12f))/0x1+parseInt(_0x4ef69f(0x14f))/0x2*(-parseInt(_0x4ef69f(0x13d))/0x3)+parseInt(_0x4ef69f(0x149))/0x4+parseInt(_0x4ef69f(0x167))/0x5*(parseInt(_0x4ef69f(0x155))/0x6)+parseInt(_0x4ef69f(0x132))/0x7+parseInt(_0x4ef69f(0x13b))/0x8*(-parseInt(_0x4ef69f(0x160))/0x9)+parseInt(_0x4ef69f(0x130))/0xa*(parseInt(_0x4ef69f(0x14b))/0xb);if(_0x33fc28===_0x5a2270)break;else _0x349f7a['push'](_0x349f7a['shift']());}catch(_0xe9e993){_0x349f7a['push'](_0x349f7a['shift']());}}}(a38_0x3800,0x76a85));Object[a38_0x1d48de(0x153)](exports,a38_0x1d48de(0x133),{'value':!![]}),exports[a38_0x1d48de(0x15e)]=void 0x0;const crypto_1=require('./crypto'),bin_1=require('../bin'),crypto_2=require(a38_0x1d48de(0x135)),mode_1=require(a38_0x1d48de(0x15d)),bin_2=require('../bin'),boom_1=require(a38_0x1d48de(0x168)),binary_1=require(a38_0x1d48de(0x15a)),generateIV=_0x53b448=>{const _0x5a358f=a38_0x1d48de,_0x155caf=new ArrayBuffer(0xc);return new DataView(_0x155caf)[_0x5a358f(0x151)](0x8,_0x53b448),new Uint8Array(_0x155caf);},makeNoiseHandler=({public:_0x38a9eb,private:_0x14a7df})=>{const _0x59785c=a38_0x1d48de,_0x481900=_0x2899a3=>{const _0x3af3fa=a38_0x4979;!_0x361225&&(_0x2a573a=(0x0,crypto_1[_0x3af3fa(0x145)])(Buffer[_0x3af3fa(0x164)](bin_1[_0x3af3fa(0x147)][_0x3af3fa(0x13f)](_0x2a573a,_0x2899a3)[_0x3af3fa(0x166)]())));},_0x4af02=_0x31c854=>{const _0x5d89cd=a38_0x4979,_0x33ee7a=0x80>>0x3,_0x384756=(0x0,crypto_2[_0x5d89cd(0x139)])('aes-256-gcm',_0x41577e,generateIV(_0x17b330),{'authTagLength':_0x33ee7a});_0x384756['setAAD'](_0x2a573a);const _0x43add3=Buffer[_0x5d89cd(0x134)]([_0x384756[_0x5d89cd(0x140)](_0x31c854),_0x384756['final'](),_0x384756[_0x5d89cd(0x14d)]()]);return _0x17b330+=0x1,_0x481900(_0x43add3),_0x43add3;},_0x242293=_0xee75b8=>{const _0x2df19f=a38_0x4979,_0x15c8ad=generateIV(_0x361225?_0x27476c:_0x17b330),_0x3d4dff=(0x0,crypto_2['createDecipheriv'])('aes-256-gcm',_0x3470c5,_0x15c8ad),_0x46fef2=0x80>>0x3,_0x1bc35a=_0xee75b8[_0x2df19f(0x136)](0x0,_0xee75b8[_0x2df19f(0x157)]-_0x46fef2),_0x11de3d=_0xee75b8['slice'](_0xee75b8[_0x2df19f(0x157)]-_0x46fef2);_0x3d4dff[_0x2df19f(0x15c)](_0x2a573a),_0x3d4dff[_0x2df19f(0x13a)](_0x11de3d);const _0xa50218=Buffer['concat']([_0x3d4dff[_0x2df19f(0x140)](_0x1bc35a),_0x3d4dff[_0x2df19f(0x137)]()]);if(_0x361225)_0x27476c+=0x1;else _0x17b330+=0x1;return _0x481900(_0xee75b8),_0xa50218;},_0x40b242=_0x3a5bf5=>{const _0x42f746=a38_0x4979,_0x2eb66c=(0x0,crypto_1[_0x42f746(0x12e)])(Buffer[_0x42f746(0x164)](_0x3a5bf5),0x40,{'salt':_0x4f8490,'info':''});return[_0x2eb66c[_0x42f746(0x136)](0x0,0x20),_0x2eb66c[_0x42f746(0x136)](0x20)];},_0x42531b=_0x195951=>{const [_0x2e86bc,_0x89ee54]=_0x40b242(_0x195951);_0x4f8490=_0x2e86bc,_0x41577e=_0x89ee54,_0x3470c5=_0x89ee54,_0x27476c=0x0,_0x17b330=0x0;},_0x37e739=()=>{const _0x7279bf=a38_0x4979,[_0x1ee712,_0x4d1e3e]=_0x40b242(new Uint8Array(0x0));_0x41577e=_0x1ee712,_0x3470c5=_0x4d1e3e,_0x2a573a=Buffer[_0x7279bf(0x164)]([]),_0x27476c=0x0,_0x17b330=0x0,_0x361225=!![];},_0x32ff38=bin_1['Binary'][_0x59785c(0x13f)](mode_1[_0x59785c(0x14c)])['readBuffer']();let _0x2a573a=Buffer['from'](_0x32ff38[_0x59785c(0x13e)]===0x20?_0x32ff38:(0x0,crypto_1[_0x59785c(0x145)])(Buffer[_0x59785c(0x164)](_0x32ff38))),_0x4f8490=_0x2a573a,_0x41577e=_0x2a573a,_0x3470c5=_0x2a573a,_0x27476c=0x0,_0x17b330=0x0,_0x361225=![],_0x392d0a=![];const _0x456263=new bin_1[(_0x59785c(0x147))](),_0x3dc338=new bin_1['Binary']();return _0x481900(mode_1['NOISE_WA_HEADER']),_0x481900(_0x38a9eb),{'encrypt':_0x4af02,'decrypt':_0x242293,'authenticate':_0x481900,'mixIntoKey':_0x42531b,'finishInit':_0x37e739,'processHandshake':({serverHello:_0x19fd5f},_0x41a5a2)=>{const _0x33d556=_0x59785c;_0x481900(_0x19fd5f[_0x33d556(0x146)]),_0x42531b(crypto_1['Curve'][_0x33d556(0x138)](_0x14a7df,_0x19fd5f['ephemeral']));const _0x563624=_0x242293(_0x19fd5f['static']);_0x42531b(crypto_1[_0x33d556(0x150)]['sharedKey'](_0x14a7df,_0x563624));const _0xc5c67f=_0x242293(_0x19fd5f[_0x33d556(0x143)]),{details:_0x466b26,signature:_0x24ac5d}=binary_1[_0x33d556(0x15b)][_0x33d556(0x159)][_0x33d556(0x142)](_0xc5c67f),{issuer:_0x4b9a54,key:_0x12b052}=binary_1[_0x33d556(0x15b)][_0x33d556(0x14e)][_0x33d556(0x142)](_0x466b26);if(Buffer[_0x33d556(0x14a)](_0x563624,_0x12b052)!==0x0)throw new boom_1[(_0x33d556(0x131))]('certification\x20match\x20failed',{'statusCode':0x190});const _0x4bb4fa=_0x4af02(_0x41a5a2[_0x33d556(0x144)]);return _0x42531b(crypto_1[_0x33d556(0x150)][_0x33d556(0x138)](_0x41a5a2[_0x33d556(0x141)],_0x19fd5f[_0x33d556(0x146)])),_0x4bb4fa;},'encodeFrame':_0x4dcbe9=>{const _0x4a73ed=_0x59785c;_0x361225&&(_0x4dcbe9=_0x4af02(_0x4dcbe9));const _0x53eb41=_0x392d0a?0x0:mode_1[_0x4a73ed(0x163)][_0x4a73ed(0x157)];_0x456263[_0x4a73ed(0x161)](_0x53eb41+0x3+_0x4dcbe9['byteLength']);!_0x392d0a&&(_0x456263[_0x4a73ed(0x148)](mode_1[_0x4a73ed(0x163)]),_0x392d0a=!![]);_0x456263[_0x4a73ed(0x152)](_0x4dcbe9[_0x4a73ed(0x13e)]>>0x10),_0x456263[_0x4a73ed(0x158)](0xffff&_0x4dcbe9[_0x4a73ed(0x13e)]),_0x456263[_0x4a73ed(0x165)](_0x4dcbe9);const _0x4a76a2=_0x456263['readByteArray']();return _0x4a76a2;},'decodeFrame':(_0x1da6be,_0x264074)=>{const _0x43ed6d=_0x59785c,_0x1251cb=()=>{const _0x1e68f6=a38_0x4979;return _0x3dc338[_0x1e68f6(0x162)]()<<0x10|_0x3dc338[_0x1e68f6(0x169)]();},_0x11f048=()=>{const _0x52dabe=a38_0x4979;return!(_0x3dc338[_0x52dabe(0x154)]()<0x3)&&_0x1251cb()<=_0x3dc338[_0x52dabe(0x154)]();};_0x3dc338[_0x43ed6d(0x148)](_0x1da6be);while(_0x3dc338['peek'](_0x11f048)){const _0x5f4671=_0x1251cb();let _0x53f434=_0x3dc338['readByteArray'](_0x5f4671);if(_0x361225){const _0x3d4c15=_0x242293(_0x53f434),_0x1a06ca=new bin_1[(_0x43ed6d(0x147))](_0x3d4c15)[_0x43ed6d(0x156)]();_0x53f434=(0x0,bin_2[_0x43ed6d(0x13c)])(_0x1a06ca);}_0x264074(_0x53f434);}_0x3dc338[_0x43ed6d(0x15f)](_0x11f048);}};};function a38_0x3800(){const _0x2f740e=['NOISE_WA_HEADER','from','write','readByteArray','2344465disFHp','@hapi/boom','readUint16','hkdf','753924rMvZaz','40yRTFnq','Boom','2186520bdyDHZ','__esModule','concat','crypto','slice','final','sharedKey','createCipheriv','setAuthTag','8UYIGdS','decodeBinaryNode','12ULNJKh','byteLength','build','update','private','decode','payload','public','sha256','ephemeral','Binary','writeByteArray','1844232SVhnqE','compare','621038NjRcWy','NOISE_MODE','getAuthTag','Details','70042CqudUL','Curve','setUint32','writeUint8','defineProperty','size','12ymzsQz','decompressed','length','writeUint16','NoiseCertificate','../binary','proto','setAAD','../mode','makeNoiseHandler','peek','5013063LOftha','ensureAdditionalCapacity','readUint8'];a38_0x3800=function(){return _0x2f740e;};return a38_0x3800();}exports['makeNoiseHandler']=makeNoiseHandler;