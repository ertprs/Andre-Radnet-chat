'use strict';function a13_0x5a0e(_0x30925d,_0x5e7555){const _0x385615=a13_0x3856();return a13_0x5a0e=function(_0x5a0eab,_0x40fede){_0x5a0eab=_0x5a0eab-0xd2;let _0x222164=_0x385615[_0x5a0eab];return _0x222164;},a13_0x5a0e(_0x30925d,_0x5e7555);}const a13_0x324c8a=a13_0x5a0e;(function(_0x1e2923,_0x51f115){const _0x5df804=a13_0x5a0e,_0x322f51=_0x1e2923();while(!![]){try{const _0x1d5a56=-parseInt(_0x5df804(0x17c))/0x1+-parseInt(_0x5df804(0x13a))/0x2+-parseInt(_0x5df804(0xed))/0x3+-parseInt(_0x5df804(0x11a))/0x4+parseInt(_0x5df804(0x147))/0x5*(-parseInt(_0x5df804(0xdf))/0x6)+parseInt(_0x5df804(0xfd))/0x7+-parseInt(_0x5df804(0xd8))/0x8*(-parseInt(_0x5df804(0xfa))/0x9);if(_0x1d5a56===_0x51f115)break;else _0x322f51['push'](_0x322f51['shift']());}catch(_0x43eb3f){_0x322f51['push'](_0x322f51['shift']());}}}(a13_0x3856,0x3e846));var __createBinding=this&&this['__createBinding']||(Object[a13_0x324c8a(0xee)]?function(_0x5d6c1a,_0x34c7a9,_0x3afc23,_0x1281c1){const _0x3f0fb6=a13_0x324c8a;if(_0x1281c1===undefined)_0x1281c1=_0x3afc23;Object[_0x3f0fb6(0x161)](_0x5d6c1a,_0x1281c1,{'enumerable':!![],'get':function(){return _0x34c7a9[_0x3afc23];}});}:function(_0x1e9016,_0x54521e,_0x271a69,_0x41be7a){if(_0x41be7a===undefined)_0x41be7a=_0x271a69;_0x1e9016[_0x41be7a]=_0x54521e[_0x271a69];}),__setModuleDefault=this&&this[a13_0x324c8a(0x11b)]||(Object[a13_0x324c8a(0xee)]?function(_0x41a22c,_0x213630){const _0x4ce73b=a13_0x324c8a;Object[_0x4ce73b(0x161)](_0x41a22c,_0x4ce73b(0x150),{'enumerable':!![],'value':_0x213630});}:function(_0x6fb6c8,_0x21c362){const _0x9cd1e4=a13_0x324c8a;_0x6fb6c8[_0x9cd1e4(0x150)]=_0x21c362;}),__importStar=this&&this['__importStar']||function(_0x11906a){const _0x3aab81=a13_0x324c8a;if(_0x11906a&&_0x11906a['__esModule'])return _0x11906a;var _0x341819={};if(_0x11906a!=null){for(var _0x5cbaf9 in _0x11906a)if(_0x5cbaf9!=='default'&&Object[_0x3aab81(0x11c)][_0x3aab81(0x111)][_0x3aab81(0x138)](_0x11906a,_0x5cbaf9))__createBinding(_0x341819,_0x11906a,_0x5cbaf9);}return __setModuleDefault(_0x341819,_0x11906a),_0x341819;},__importDefault=this&&this[a13_0x324c8a(0x14d)]||function(_0x19c57d){const _0x34aa2a=a13_0x324c8a;return _0x19c57d&&_0x19c57d[_0x34aa2a(0xea)]?_0x19c57d:{'default':_0x19c57d};};Object[a13_0x324c8a(0x161)](exports,a13_0x324c8a(0xea),{'value':!![]}),exports['extensionForMediaMessage']=exports[a13_0x324c8a(0x12a)]=exports[a13_0x324c8a(0x102)]=exports[a13_0x324c8a(0xda)]=exports['generateThumbnail']=exports[a13_0x324c8a(0xff)]=exports['toReadable']=exports[a13_0x324c8a(0x133)]=exports[a13_0x324c8a(0x17a)]=exports[a13_0x324c8a(0xfe)]=exports[a13_0x324c8a(0x164)]=exports[a13_0x324c8a(0x13c)]=exports[a13_0x324c8a(0x131)]=exports[a13_0x324c8a(0x124)]=exports[a13_0x324c8a(0xde)]=exports[a13_0x324c8a(0x186)]=exports[a13_0x324c8a(0x172)]=exports[a13_0x324c8a(0x13f)]=exports[a13_0x324c8a(0x12f)]=exports[a13_0x324c8a(0xe1)]=exports[a13_0x324c8a(0x10c)]=exports[a13_0x324c8a(0x104)]=exports[a13_0x324c8a(0x17b)]=exports[a13_0x324c8a(0x149)]=exports['sha256']=exports[a13_0x324c8a(0x151)]=exports[a13_0x324c8a(0x168)]=exports['aesEncrypt']=exports['aesDecryptWithIV']=exports[a13_0x324c8a(0x17f)]=exports[a13_0x324c8a(0x152)]=exports[a13_0x324c8a(0x113)]=exports[a13_0x324c8a(0x163)]=exports[a13_0x324c8a(0x14e)]=exports[a13_0x324c8a(0x189)]=exports['WA_MESSAGE_ID']=exports[a13_0x324c8a(0x15d)]=exports[a13_0x324c8a(0x155)]=exports[a13_0x324c8a(0xeb)]=exports['Browsers']=exports[a13_0x324c8a(0x10f)]=void 0x0;const Crypto=__importStar(require('crypto')),stream_1=require(a13_0x324c8a(0x167)),futoin_hkdf_1=__importDefault(require(a13_0x324c8a(0x135))),jimp_1=__importDefault(require('jimp')),fs_1=require('fs'),child_process_1=require(a13_0x324c8a(0x18b)),os_1=require('os'),https_proxy_agent_1=__importDefault(require(a13_0x324c8a(0x10a))),variables_1=require('./variables'),FluidDB_1=__importDefault(require('../db/FluidDB')),got_1=__importDefault(require(a13_0x324c8a(0xe9))),path_1=require(a13_0x324c8a(0x107)),events_1=require(a13_0x324c8a(0x139)),path=__importStar(require(a13_0x324c8a(0x107))),bs=require(a13_0x324c8a(0x171));require(a13_0x324c8a(0x117))['config']({'path':path[a13_0x324c8a(0x184)](__dirname,a13_0x324c8a(0xe2))}),exports[a13_0x324c8a(0x10f)]=process[a13_0x324c8a(0x187)][a13_0x324c8a(0x178)];const platformMap={'aix':a13_0x324c8a(0x182),'darwin':a13_0x324c8a(0x162),'win32':a13_0x324c8a(0x101),'android':a13_0x324c8a(0x134)};exports[a13_0x324c8a(0x11d)]={'ubuntu':_0x153627=>[a13_0x324c8a(0xe0),_0x153627,a13_0x324c8a(0xfc)],'macOS':_0x2e8825=>[a13_0x324c8a(0x162),_0x2e8825,a13_0x324c8a(0xfb)],'WP':_0x35fde4=>[exports[a13_0x324c8a(0x10f)],_0x35fde4,a13_0x324c8a(0x115)],'appropriate':_0x2d99a4=>[platformMap[os_1[a13_0x324c8a(0x14f)]()]||a13_0x324c8a(0xe0),_0x2d99a4,os_1[a13_0x324c8a(0x127)]()]};const toNumber=_0x3c4d61=>_0x3c4d61[a13_0x324c8a(0x125)]||_0x3c4d61;exports[a13_0x324c8a(0xeb)]=toNumber;const waChatKey=_0x3d04d4=>({'key':_0xd387d=>(_0x3d04d4?_0xd387d['pin']?'1':'0':'')+(_0xd387d['archive']==='true'?'0':'1')+_0xd387d['t'][a13_0x324c8a(0x18c)](0x10)['padStart'](0x8,'0')+_0xd387d['jid'],'compare':(_0x50911d,_0x6b4fc6)=>_0x6b4fc6['localeCompare'](_0x50911d)});exports['waChatKey']=waChatKey,exports[a13_0x324c8a(0x15d)]={'key':_0xdc11d5=>(0x1388+(_0xdc11d5['epoch']||0x0))[a13_0x324c8a(0x18c)](0x10)[a13_0x324c8a(0xef)](0x6,'0')+exports['toNumber'](_0xdc11d5[a13_0x324c8a(0xf3)])[a13_0x324c8a(0x18c)](0x10)[a13_0x324c8a(0xef)](0x8,'0'),'compare':(_0x4c4108,_0x44b401)=>_0x4c4108['localeCompare'](_0x44b401)};const WA_MESSAGE_ID=_0x11ff27=>exports[a13_0x324c8a(0x189)](_0x11ff27[a13_0x324c8a(0x17d)]);exports[a13_0x324c8a(0x140)]=WA_MESSAGE_ID;const GET_MESSAGE_ID=_0x193e70=>_0x193e70['id']+'|'+(_0x193e70[a13_0x324c8a(0x173)]?0x1:0x0);function a13_0x3856(){const _0x49df2d=['resolve','generateThumbnail','generateClientID','env','productImage','GET_MESSAGE_ID','width','child_process','toString','mediaKey','pipe','mimetype','slice','unknown\x20message\x20type','extensionForMediaMessage','product','8PGfwnV','@c.us','getGotStream','DEFAULT_ORIGIN','location','concat','generateMessageID','656322XShkTt','Ubuntu','delay','../../.env','thumbnail','url','stack','@s.whatsapp.net','split','finally','got','__esModule','toNumber','aesDecryptWithIV','551304RBRLVw','create','padStart','http://','exec','createDecipheriv','messageTimestamp','height','isBuffer','length','getHeight','min','music-metadata','11376927mWZpNz','10.15.3','18.04','2909417RAtxaU','ProxyAgent','getStream','parse','Windows','encryptedStream','Erros','unixTimestampSeconds','forEach','endsWith','path','write','createWriteStream','https-proxy-agent','file','debouncedTimeout','duration','getWidth','BRAND','values','hasOwnProperty','format','newMessagesDB','\x20-vframes\x201\x20-f\x20image2\x20','3.0','liveLocation','dotenv','floor','TimedOutError','1731132ZNoJnr','__setModuleDefault','prototype','Browsers','resize','tmpdir','keys','createHmac','Transform','SHA-256','decryptWA','low','digest','release','toUpperCase','push','decryptMediaMessageBuffer','read','jpegThumbnail','checksum\x20failed','parseStream','delayCancellable','.enc','getMediaKeys','drain','getAudioDuration','Android','futoin-hkdf','update','ffmpeg\x20-ss\x20','call','events','280532MntNrE','data:;base64,','compressImage','productMessage','aes-256-cbc','promiseTimeout','WA_MESSAGE_ID','Readable','base64','replace','invalid\x20message','3EB0','alloc','15twElHy','00:00:00','hkdf','final','@g.us','get','__importDefault','whatsappID','platform','default','hmacSign','shallowChanges','could\x20not\x20generate\x20video\x20thumb:\x20','image','waChatKey','recieved\x20encrypted\x20buffer\x20when\x20auth\x20creds\x20unavailable','catch','once','sha256','video','text','close','waMessageKey','createReadStream','MIME_JPEG','readFile','defineProperty','Mac\x20OS','isGroupID','generateProfilePicture','createHash','buffer','stream','aesEncrypWithIV','.jpeg','MessageType','createCipheriv','from',')\x20returned','startsWith','join','fileSha256','atob','generateMessageTag','fromMe','promises','audio','insert','getBufferAsync','NAME','hex','mediaMessageSHA256B64','randomBytes','338686eeGELJ','key','indexOf','aesDecrypt','parseBuffer','\x20-y\x20-s\x20','AIX','toReadable'];a13_0x3856=function(){return _0x49df2d;};return a13_0x3856();}exports['GET_MESSAGE_ID']=GET_MESSAGE_ID;const whatsappID=_0x2bf0af=>_0x2bf0af===null||_0x2bf0af===void 0x0?void 0x0:_0x2bf0af[a13_0x324c8a(0x143)](a13_0x324c8a(0xd9),a13_0x324c8a(0xe6));exports['whatsappID']=whatsappID;const isGroupID=_0x38963e=>_0x38963e===null||_0x38963e===void 0x0?void 0x0:_0x38963e[a13_0x324c8a(0x106)](a13_0x324c8a(0x14b));exports['isGroupID']=isGroupID;const newMessagesDB=(_0x474919=[])=>{const _0x23f24f=a13_0x324c8a,_0x3e935b=new FluidDB_1['default'](exports[_0x23f24f(0x15d)],exports['WA_MESSAGE_ID']);return _0x474919[_0x23f24f(0x105)](_0x8f9bee=>!_0x3e935b[_0x23f24f(0x14c)](exports[_0x23f24f(0x140)](_0x8f9bee))&&_0x3e935b[_0x23f24f(0x176)](_0x8f9bee)),_0x3e935b;};exports[a13_0x324c8a(0x113)]=newMessagesDB;function shallowChanges(_0x393b91,_0x50198f,{lookForDeletedKeys:_0x3b8f39}){let _0x589bd0={};for(let _0x51e230 in _0x50198f){_0x393b91[_0x51e230]!==_0x50198f[_0x51e230]&&(_0x589bd0[_0x51e230]=_0x50198f[_0x51e230]||null);}if(_0x3b8f39)for(let _0x5ed646 in _0x393b91){!_0x589bd0[_0x5ed646]&&_0x393b91[_0x5ed646]!==_0x50198f[_0x5ed646]&&(_0x589bd0[_0x5ed646]=_0x50198f[_0x5ed646]||null);}return _0x589bd0;}exports['shallowChanges']=shallowChanges;function aesDecrypt(_0xe94e42,_0x216093){const _0x28523d=a13_0x324c8a;return aesDecryptWithIV(_0xe94e42[_0x28523d(0xd4)](0x10,_0xe94e42['length']),_0x216093,_0xe94e42[_0x28523d(0xd4)](0x0,0x10));}exports[a13_0x324c8a(0x17f)]=aesDecrypt;function aesDecryptWithIV(_0x3f80f5,_0x372d3e,_0xf2f1db){const _0x134e86=a13_0x324c8a,_0x202776=Crypto[_0x134e86(0xf2)](_0x134e86(0x13e),_0x372d3e,_0xf2f1db);return Buffer[_0x134e86(0xdd)]([_0x202776[_0x134e86(0x136)](_0x3f80f5),_0x202776[_0x134e86(0x14a)]()]);}exports[a13_0x324c8a(0xec)]=aesDecryptWithIV;function aesEncrypt(_0xdfdd4e,_0x3e1637){const _0x4a82b3=a13_0x324c8a,_0x5dd2a7=randomBytes(0x10),_0x210d33=Crypto[_0x4a82b3(0x16b)]('aes-256-cbc',_0x3e1637,_0x5dd2a7);return Buffer[_0x4a82b3(0xdd)]([_0x5dd2a7,_0x210d33[_0x4a82b3(0x136)](_0xdfdd4e),_0x210d33[_0x4a82b3(0x14a)]()]);}exports['aesEncrypt']=aesEncrypt;function aesEncrypWithIV(_0x38fb4b,_0x546dc3,_0x1b899c){const _0x24f957=a13_0x324c8a,_0x5a6c77=Crypto[_0x24f957(0x16b)](_0x24f957(0x13e),_0x546dc3,_0x1b899c);return Buffer[_0x24f957(0xdd)]([_0x5a6c77[_0x24f957(0x136)](_0x38fb4b),_0x5a6c77[_0x24f957(0x14a)]()]);}exports[a13_0x324c8a(0x168)]=aesEncrypWithIV;function hmacSign(_0x30eeb8,_0x5dfe19){const _0x1ab47f=a13_0x324c8a;return Crypto[_0x1ab47f(0x121)](_0x1ab47f(0x159),_0x5dfe19)[_0x1ab47f(0x136)](_0x30eeb8)[_0x1ab47f(0x126)]();}exports[a13_0x324c8a(0x151)]=hmacSign;function sha256(_0xa18eb0){const _0x4ef87e=a13_0x324c8a;return Crypto['createHash'](_0x4ef87e(0x159))['update'](_0xa18eb0)[_0x4ef87e(0x126)]();}exports[a13_0x324c8a(0x159)]=sha256;function hkdf(_0x4e126c,_0x52bdee,_0x2880a3=null){const _0x1fe6e8=a13_0x324c8a;return futoin_hkdf_1[_0x1fe6e8(0x150)](_0x4e126c,_0x52bdee,{'salt':Buffer[_0x1fe6e8(0x146)](0x20),'info':_0x2880a3,'hash':_0x1fe6e8(0x123)});}exports[a13_0x324c8a(0x149)]=hkdf;function randomBytes(_0xa224bc){const _0x2a0f85=a13_0x324c8a;return Crypto[_0x2a0f85(0x17b)](_0xa224bc);}exports[a13_0x324c8a(0x17b)]=randomBytes;const unixTimestampSeconds=(_0x1df721=new Date())=>Math['floor'](_0x1df721['getTime']()/0x3e8);exports[a13_0x324c8a(0x104)]=unixTimestampSeconds;const debouncedTimeout=(_0x30a65e=0x3e8,_0x1f7602=undefined)=>{let _0x426c9c;return{'start':(_0x2be9f5,_0x1d4968)=>{_0x1f7602=_0x1d4968||_0x1f7602,_0x30a65e=_0x2be9f5||_0x30a65e,_0x426c9c&&clearTimeout(_0x426c9c),_0x426c9c=setTimeout(_0x1f7602,_0x30a65e);},'cancel':()=>{_0x426c9c&&clearTimeout(_0x426c9c),_0x426c9c=undefined;},'setTask':_0x1c5a6c=>_0x1f7602=_0x1c5a6c,'setInterval':_0x55509d=>_0x30a65e=_0x55509d};};exports[a13_0x324c8a(0x10c)]=debouncedTimeout;const delay=_0x14da04=>exports[a13_0x324c8a(0x12f)](_0x14da04)[a13_0x324c8a(0xe1)];exports[a13_0x324c8a(0xe1)]=delay;const delayCancellable=_0xfc0ac5=>{const _0x10389b=a13_0x324c8a,_0xca36ee=new Error()[_0x10389b(0xe5)];let _0x3981e4,_0x364ec8;const _0x55b6a7=new Promise((_0x1c72fe,_0x16a37e)=>{_0x3981e4=setTimeout(_0x1c72fe,_0xfc0ac5),_0x364ec8=_0x16a37e;}),_0x3d182d=()=>{clearTimeout(_0x3981e4),_0x364ec8(variables_1['CancelledError'](_0xca36ee));};return{'delay':_0x55b6a7,'cancel':_0x3d182d};};exports[a13_0x324c8a(0x12f)]=delayCancellable;async function promiseTimeout(_0xc049c,_0x2eee64){const _0x23bb82=a13_0x324c8a;if(!_0xc049c)return new Promise(_0x2eee64);const _0x34a53f=new Error()[_0x23bb82(0xe5)];let {delay:_0x4b6d5b,cancel:_0x162b4f}=exports[_0x23bb82(0x12f)](_0xc049c);const _0x39fe47=new Promise((_0x2bb141,_0x465d28)=>{const _0x3a142f=_0x23bb82;_0x4b6d5b['then'](()=>_0x465d28(variables_1[_0x3a142f(0x119)](_0x34a53f)))[_0x3a142f(0x157)](_0x38de3a=>_0x465d28(_0x38de3a)),_0x2eee64(_0x2bb141,_0x465d28);})[_0x23bb82(0xe8)](_0x162b4f);return _0x39fe47;}exports['promiseTimeout']=promiseTimeout;function generateMessageTag(_0x33c498){let _0x114416=exports['unixTimestampSeconds']()['toString']();if(_0x33c498)_0x114416+='.--'+_0x33c498;return _0x114416;}exports[a13_0x324c8a(0x172)]=generateMessageTag;function generateClientID(){const _0x5a55e2=a13_0x324c8a;return randomBytes(0x10)[_0x5a55e2(0x18c)](_0x5a55e2(0x142));}exports[a13_0x324c8a(0x186)]=generateClientID;function generateMessageID(){const _0x33b121=a13_0x324c8a;return _0x33b121(0x145)+randomBytes(0x4)[_0x33b121(0x18c)](_0x33b121(0x179))[_0x33b121(0x128)]();}exports[a13_0x324c8a(0xde)]=generateMessageID;function decryptWA(_0x21b603,_0x5afec4,_0x543e01,_0x454e1a,_0x1449c4=![]){const _0x307e1d=a13_0x324c8a;let _0x58d7f1=_0x21b603[_0x307e1d(0x17e)](',');if(_0x58d7f1<0x0)throw new variables_1[(_0x307e1d(0x103))](_0x307e1d(0x144),{'message':_0x21b603});if(_0x21b603[_0x58d7f1+0x1]===',')_0x58d7f1+=0x1;let _0xa3cc43=_0x21b603[_0x307e1d(0xd4)](_0x58d7f1+0x1,_0x21b603['length']);const _0x4d5c0d=_0x21b603['slice'](0x0,_0x58d7f1)[_0x307e1d(0x18c)]();let _0x3e8bf9,_0x57f100;if(_0xa3cc43[_0x307e1d(0xf6)]>0x0){if(typeof _0xa3cc43==='string')_0x3e8bf9=JSON[_0x307e1d(0x100)](_0xa3cc43);else{if(!_0x5afec4||!_0x543e01)throw new variables_1[(_0x307e1d(0x103))](_0x307e1d(0x156),{'message':_0x21b603});_0x1449c4&&(_0x57f100=[_0xa3cc43[0x0],_0xa3cc43[0x1]],_0xa3cc43=_0xa3cc43[_0x307e1d(0xd4)](0x2,_0xa3cc43[_0x307e1d(0xf6)]));const _0x1e559b=_0xa3cc43[_0x307e1d(0xd4)](0x0,0x20);_0xa3cc43=_0xa3cc43['slice'](0x20,_0xa3cc43[_0x307e1d(0xf6)]);const _0x16c25f=hmacSign(_0xa3cc43,_0x5afec4);if(_0x1e559b['equals'](_0x16c25f)){const _0x4b2b73=aesDecrypt(_0xa3cc43,_0x543e01);_0x3e8bf9=_0x454e1a[_0x307e1d(0x12b)](_0x4b2b73);}else throw new variables_1[(_0x307e1d(0x103))](_0x307e1d(0x12d),{'received':_0x1e559b[_0x307e1d(0x18c)](_0x307e1d(0x179)),'computed':_0x16c25f['toString']('hex'),'data':_0xa3cc43[_0x307e1d(0xd4)](0x0,0x50)[_0x307e1d(0x18c)](),'tag':_0x4d5c0d,'message':_0x21b603[_0x307e1d(0xd4)](0x0,0x50)[_0x307e1d(0x18c)]()});}}return[_0x4d5c0d,_0x3e8bf9,_0x57f100];}exports['decryptWA']=decryptWA;function getMediaKeys(_0x420f2a,_0x43511c){const _0x46d62e=a13_0x324c8a;typeof _0x420f2a==='string'&&(_0x420f2a=Buffer[_0x46d62e(0x16c)](_0x420f2a[_0x46d62e(0x143)](_0x46d62e(0x13b),''),_0x46d62e(0x142)));const _0x145040=hkdf(_0x420f2a,0x70,variables_1['HKDFInfoKeys'][_0x43511c]);return{'iv':_0x145040[_0x46d62e(0xd4)](0x0,0x10),'cipherKey':_0x145040[_0x46d62e(0xd4)](0x10,0x30),'macKey':_0x145040['slice'](0x30,0x50)};}exports['getMediaKeys']=getMediaKeys;const extractVideoThumb=async(_0x49e9f7,_0x360846,_0x10ba18,_0x542aa3)=>new Promise((_0x55a5b1,_0x439e28)=>{const _0xb2da90=a13_0x324c8a,_0xc727e2=_0xb2da90(0x137)+_0x10ba18+'\x20-i\x20'+_0x49e9f7+_0xb2da90(0x181)+_0x542aa3[_0xb2da90(0x18a)]+'x'+_0x542aa3[_0xb2da90(0xf4)]+_0xb2da90(0x114)+_0x360846;child_process_1[_0xb2da90(0xf1)](_0xc727e2,_0x4317ca=>{if(_0x4317ca)_0x439e28(_0x4317ca);else _0x55a5b1();});}),compressImage=async _0x55811e=>{const _0x13714a=a13_0x324c8a,_0x1d98c6=await jimp_1['default']['read'](_0x55811e),_0x34132e=await _0x1d98c6[_0x13714a(0x11e)](0x30,0x30)['getBufferAsync'](jimp_1[_0x13714a(0x150)][_0x13714a(0x15f)]);return _0x34132e;};exports[a13_0x324c8a(0x13c)]=compressImage;const generateProfilePicture=async _0x29695b=>{const _0x3a3323=a13_0x324c8a,_0x2c7e22=await jimp_1[_0x3a3323(0x150)][_0x3a3323(0x12b)](_0x29695b),_0x4c5e0d=Math[_0x3a3323(0xf8)](_0x2c7e22[_0x3a3323(0x10e)](),_0x2c7e22[_0x3a3323(0xf7)]()),_0x427be8=_0x2c7e22['crop'](0x0,0x0,_0x4c5e0d,_0x4c5e0d);return{'img':await _0x427be8[_0x3a3323(0x11e)](0x280,0x280)[_0x3a3323(0x177)](jimp_1[_0x3a3323(0x150)]['MIME_JPEG']),'preview':await _0x427be8['resize'](0x60,0x60)['getBufferAsync'](jimp_1['default']['MIME_JPEG'])};};exports[a13_0x324c8a(0x164)]=generateProfilePicture;const ProxyAgent=_0x1add09=>https_proxy_agent_1[a13_0x324c8a(0x150)](_0x1add09);exports[a13_0x324c8a(0xfe)]=ProxyAgent;const mediaMessageSHA256B64=_0x58abde=>{const _0x325e6e=a13_0x324c8a,_0xe646f=Object[_0x325e6e(0x110)](_0x58abde)[0x0];return(_0xe646f===null||_0xe646f===void 0x0?void 0x0:_0xe646f[_0x325e6e(0x170)])&&Buffer[_0x325e6e(0x16c)](_0xe646f[_0x325e6e(0x170)])[_0x325e6e(0x18c)](_0x325e6e(0x142));};exports[a13_0x324c8a(0x17a)]=mediaMessageSHA256B64;async function getAudioDuration(_0x491bc3){const _0x41f12d=a13_0x324c8a,_0x8c5c31=await Promise[_0x41f12d(0x184)]()['then'](()=>__importStar(require(_0x41f12d(0xf9))));let _0x210cd4;if(Buffer[_0x41f12d(0xf5)](_0x491bc3))_0x210cd4=await _0x8c5c31[_0x41f12d(0x180)](_0x491bc3,null,{'duration':!![]});else{const _0x125359=fs_1[_0x41f12d(0x15e)](_0x491bc3);_0x210cd4=await _0x8c5c31[_0x41f12d(0x12e)](_0x125359,null,{'duration':!![]}),_0x125359[_0x41f12d(0x15c)]();}return _0x210cd4[_0x41f12d(0x112)][_0x41f12d(0x10d)];}exports[a13_0x324c8a(0x133)]=getAudioDuration;const toReadable=_0x199aa1=>{const _0x3b82f5=a13_0x324c8a,_0x20c498=new stream_1[(_0x3b82f5(0x141))]({'read':()=>{}});return _0x20c498[_0x3b82f5(0x129)](_0x199aa1),_0x20c498[_0x3b82f5(0x129)](null),_0x20c498;};exports[a13_0x324c8a(0x183)]=toReadable;const getStream=async _0x236470=>{const _0xf44bd1=a13_0x324c8a;if(Buffer['isBuffer'](_0x236470))return{'stream':exports[_0xf44bd1(0x183)](_0x236470),'type':_0xf44bd1(0x166)};if(_0x236470[_0xf44bd1(0xe4)][_0xf44bd1(0x18c)]()['startsWith'](_0xf44bd1(0xf0))||_0x236470[_0xf44bd1(0xe4)]['toString']()[_0xf44bd1(0x16e)]('https://'))return{'stream':await exports['getGotStream'](_0x236470['url']),'type':'remote'};return{'stream':fs_1[_0xf44bd1(0x15e)](_0x236470[_0xf44bd1(0xe4)]),'type':'file'};};exports[a13_0x324c8a(0xff)]=getStream;async function generateThumbnail(_0x14bd01,_0x514b26,_0x1adea5){const _0x587b44=a13_0x324c8a;if(_0x587b44(0xe3)in _0x1adea5){if(_0x514b26===variables_1[_0x587b44(0x16a)][_0x587b44(0x175)])throw new Error('audio\x20messages\x20cannot\x20have\x20thumbnails');}else{if(_0x514b26===variables_1[_0x587b44(0x16a)][_0x587b44(0x154)]){const _0x169797=await exports[_0x587b44(0x13c)](_0x14bd01);_0x1adea5[_0x587b44(0xe3)]=_0x169797[_0x587b44(0x18c)](_0x587b44(0x142));}else{if(_0x514b26===variables_1['MessageType'][_0x587b44(0x15a)]){const _0x380fab=path_1['join'](os_1['tmpdir'](),generateMessageID()+'.jpg');try{await extractVideoThumb(_0x14bd01,_0x380fab,_0x587b44(0x148),{'width':0x30,'height':0x30});const _0x2813e3=await fs_1[_0x587b44(0x174)][_0x587b44(0x160)](_0x380fab);_0x1adea5[_0x587b44(0xe3)]=_0x2813e3[_0x587b44(0x18c)](_0x587b44(0x142)),await fs_1[_0x587b44(0x174)]['unlink'](_0x380fab);}catch(_0x65889a){console['log'](_0x587b44(0x153)+_0x65889a);}}}}}exports[a13_0x324c8a(0x185)]=generateThumbnail;const getGotStream=async(_0xafc330,_0xbb9c7b={})=>{const _0x1a86c4=a13_0x324c8a,_0x167936=got_1['default'][_0x1a86c4(0x167)](_0xafc330,{..._0xbb9c7b,'isStream':!![]});return await new Promise((_0x52a56d,_0x1a053a)=>{const _0x1dce90=_0x1a86c4;_0x167936[_0x1dce90(0x158)]('error',_0x1a053a),_0x167936[_0x1dce90(0x158)]('response',({statusCode:_0x479117})=>{const _0x1b57e7=_0x1dce90;_0x479117>=0x190?_0x1a053a(new variables_1[(_0x1b57e7(0x103))]('Invalid\x20code\x20('+_0x479117+_0x1b57e7(0x16d),{'status':_0x479117})):_0x52a56d(undefined);});}),_0x167936;};exports['getGotStream']=getGotStream;const encryptedStream=async(_0x584d79,_0x562824,_0x18f92a=!![])=>{const _0x410354=a13_0x324c8a,{stream:_0x31b50f,type:_0x376032}=await exports[_0x410354(0xff)](_0x584d79),_0x3a2c0a=randomBytes(0x20),{cipherKey:_0x1e0256,iv:_0x3baaaa,macKey:_0x2acf00}=getMediaKeys(_0x3a2c0a,_0x562824),_0x67b011=path_1[_0x410354(0x16f)](os_1[_0x410354(0x11f)](),_0x562824+generateMessageID()+_0x410354(0x130)),_0x20d6d9=fs_1['createWriteStream'](_0x67b011);let _0x1078cc,_0x1b215b;if(_0x376032===_0x410354(0x10b))_0x1078cc=_0x584d79[_0x410354(0xe4)];else _0x18f92a&&(_0x1078cc=path_1[_0x410354(0x16f)](os_1['tmpdir'](),_0x562824+generateMessageID()),_0x1b215b=fs_1[_0x410354(0x109)](_0x1078cc));let _0x246620=0x0;const _0x184317=Crypto['createCipheriv']('aes-256-cbc',_0x1e0256,_0x3baaaa);let _0x48d749=Crypto[_0x410354(0x121)](_0x410354(0x159),_0x2acf00)[_0x410354(0x136)](_0x3baaaa),_0x49faa5=Crypto[_0x410354(0x165)]('sha256'),_0xed2202=Crypto[_0x410354(0x165)](_0x410354(0x159));const _0x331643=_0x5702cd=>{const _0x490a33=_0x410354;_0xed2202=_0xed2202[_0x490a33(0x136)](_0x5702cd),_0x48d749=_0x48d749[_0x490a33(0x136)](_0x5702cd),_0x20d6d9[_0x490a33(0x108)](_0x5702cd);};for await(const _0x1baa20 of _0x31b50f){_0x246620+=_0x1baa20[_0x410354(0xf6)],_0x49faa5=_0x49faa5[_0x410354(0x136)](_0x1baa20);if(_0x1b215b&&!_0x1b215b[_0x410354(0x108)](_0x1baa20))await events_1['once'](_0x1b215b,_0x410354(0x132));_0x331643(_0x184317[_0x410354(0x136)](_0x1baa20));}_0x331643(_0x184317[_0x410354(0x14a)]());const _0x5b2c31=_0x48d749[_0x410354(0x126)]()['slice'](0x0,0xa);_0xed2202=_0xed2202['update'](_0x5b2c31);const _0x2d304f=_0x49faa5[_0x410354(0x126)](),_0x1a7d32=_0xed2202[_0x410354(0x126)]();return _0x20d6d9[_0x410354(0x108)](_0x5b2c31),_0x20d6d9['end'](),_0x1b215b&&_0x1b215b['end'](),{'mediaKey':_0x3a2c0a,'encBodyPath':_0x67b011,'bodyPath':_0x1078cc,'mac':_0x5b2c31,'fileEncSha256':_0x1a7d32,'fileSha256':_0x2d304f,'fileLength':_0x246620,'didSaveToTmpPath':_0x376032!=='file'};};exports['encryptedStream']=encryptedStream;async function decryptMediaMessageBuffer(_0x253adc){const _0x3b1931=a13_0x324c8a;var _0x3a037;const _0x68ae7d=Object[_0x3b1931(0x120)](_0x253adc)[0x0];if(!_0x68ae7d)throw new variables_1[(_0x3b1931(0x103))](_0x3b1931(0xd5),_0x253adc);if(_0x68ae7d===variables_1['MessageType'][_0x3b1931(0x15b)]||_0x68ae7d===variables_1[_0x3b1931(0x16a)]['extendedText'])throw new variables_1[(_0x3b1931(0x103))]('cannot\x20decode\x20text\x20message',_0x253adc);if(_0x68ae7d===variables_1[_0x3b1931(0x16a)]['location']||_0x68ae7d===variables_1[_0x3b1931(0x16a)][_0x3b1931(0x116)]){const _0x2ba4c5=Buffer[_0x3b1931(0x16c)](_0x253adc[_0x68ae7d][_0x3b1931(0x12c)]),_0x37e8d0=new stream_1['Readable']({'read':()=>{}});return _0x37e8d0['push'](_0x2ba4c5),_0x37e8d0[_0x3b1931(0x129)](null),_0x37e8d0;}let _0x1af6e7;if(_0x253adc[_0x3b1931(0x13d)]){const _0x1a1c50=(_0x3a037=_0x253adc['productMessage'][_0x3b1931(0xd7)])===null||_0x3a037===void 0x0?void 0x0:_0x3a037[_0x3b1931(0x188)];if(!_0x1a1c50)throw new variables_1[(_0x3b1931(0x103))]('product\x20has\x20no\x20image',_0x253adc);_0x1af6e7=_0x1a1c50;}else _0x1af6e7=_0x253adc[_0x68ae7d];const _0x465a75=await exports[_0x3b1931(0xda)](_0x1af6e7[_0x3b1931(0xe4)],{'headers':{'Origin':variables_1[_0x3b1931(0xdb)]}});let _0x3f2274=Buffer[_0x3b1931(0x16c)]([]);const {cipherKey:_0x2a05e7,iv:_0x205157}=getMediaKeys(_0x1af6e7[_0x3b1931(0x18d)],_0x68ae7d),_0x1d8c2f=Crypto[_0x3b1931(0xf2)]('aes-256-cbc',_0x2a05e7,_0x205157),_0x24e55a=new stream_1[(_0x3b1931(0x122))]({'transform'(_0x20b207,_0x55eceb,_0x3613f3){const _0x4f85f2=_0x3b1931;let _0x211c0f=Buffer[_0x4f85f2(0xdd)]([_0x3f2274,_0x20b207]);const _0x28f22b=Math[_0x4f85f2(0x118)](_0x211c0f[_0x4f85f2(0xf6)]/0x10)*0x10;_0x3f2274=_0x211c0f[_0x4f85f2(0xd4)](_0x28f22b),_0x211c0f=_0x211c0f[_0x4f85f2(0xd4)](0x0,_0x28f22b);try{this[_0x4f85f2(0x129)](_0x1d8c2f[_0x4f85f2(0x136)](_0x211c0f)),_0x3613f3();}catch(_0x1bea77){_0x3613f3(_0x1bea77);}},'final'(_0x270505){const _0x2849db=_0x3b1931;try{this['push'](_0x1d8c2f[_0x2849db(0x14a)]()),_0x270505();}catch(_0x1e780f){_0x270505(_0x1e780f);}}});return _0x465a75[_0x3b1931(0xd2)](_0x24e55a,{'end':!![]});}exports[a13_0x324c8a(0x12a)]=decryptMediaMessageBuffer;function extensionForMediaMessage(_0x1d1431){const _0x3a6cc3=a13_0x324c8a,_0x12ca16=_0x311cd9=>_0x311cd9[_0x3a6cc3(0xe7)](';')[0x0][_0x3a6cc3(0xe7)]('/')[0x1],_0x390e1f=Object[_0x3a6cc3(0x120)](_0x1d1431)[0x0];let _0x308ab4;if(_0x390e1f===variables_1[_0x3a6cc3(0x16a)][_0x3a6cc3(0xdc)]||_0x390e1f===variables_1[_0x3a6cc3(0x16a)]['liveLocation']||_0x390e1f===variables_1[_0x3a6cc3(0x16a)][_0x3a6cc3(0xd7)])_0x308ab4=_0x3a6cc3(0x169);else{const _0x2d99c2=_0x1d1431[_0x390e1f];_0x308ab4=_0x12ca16(_0x2d99c2[_0x3a6cc3(0xd3)]);}return _0x308ab4;}exports[a13_0x324c8a(0xd6)]=extensionForMediaMessage;